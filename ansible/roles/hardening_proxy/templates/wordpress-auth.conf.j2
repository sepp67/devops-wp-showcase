[Definition]
# Caddy JSON access logs (one line = one JSON object)
# We match WordPress brute-force & abuse endpoints at the proxy:
# - /wp-login.php (GET/POST)
# - /xmlrpc.php (POST/GET)
#
# Fail2ban expects <HOST> somewhere on the line; in Caddy logs it is typically "remote_ip":"x.x.x.x"
#
# Regex notes:
# - We match both potential structures:
#   1) ..."request":{"method":"GET","uri":"/wp-login.php"...}...
#   2) ..."uri":"/wp-login.php"... (some formats / variations)
#
failregex = ^.*"remote_ip"\s*:\s*"<HOST>".*"method"\s*:\s*"(GET|POST)".*"uri"\s*:\s*"/wp-login\.php([^"]*)".*$
            ^.*"remote_ip"\s*:\s*"<HOST>".*"method"\s*:\s*"(GET|POST)".*"uri"\s*:\s*"/xmlrpc\.php([^"]*)".*$
            ^.*"remote_ip"\s*:\s*"<HOST>".*"uri"\s*:\s*"/wp-login\.php([^"]*)".*$
            ^.*"remote_ip"\s*:\s*"<HOST>".*"uri"\s*:\s*"/xmlrpc\.php([^"]*)".*$

ignoreregex =
